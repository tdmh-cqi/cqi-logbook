<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CQI's Receiving Record</title>
    
    <!-- Tailwind CSS for Styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM (Translators) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel (Translates JSX to JavaScript in the browser) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body { overscroll-behavior-y: contain; }
        .glass-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }
        .medical-gradient {
            background: linear-gradient(135deg, #0f766e 0%, #0369a1 100%);
        }
    </style>
</head>
<body class="bg-slate-100 min-h-screen">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useCallback } = React;

        // --- SVG Icons Components ---
        const IconRefresh = ({ className, size = 24 }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/></svg>;
        const IconCheckCircle = ({ className, size = 24 }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>;
        const IconAlertCircle = ({ className, size = 24 }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><line x1="12" x2="12" y1="8" y2="12"/><line x1="12" x2="12.01" y1="16" y2="16"/></svg>;
        const IconTrash = ({ className, size = 24 }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg>;
        const IconPen = ({ className, size = 24 }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M12 19l7-7 3 3-7 7-3-3z"/><path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"/><path d="M2 2l7.586 7.586"/><circle cx="11" cy="11" r="2"/></svg>;
        const IconSend = ({ className, size = 24 }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m22 2-7 20-4-9-9-4Z"/><path d="M22 2 11 13"/></svg>;
        const IconFileText = ({ className, size = 24 }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/><path d="M14 2v4a2 2 0 0 0 2 2h4"/><path d="M10 9H8"/><path d="M16 13H8"/><path d="M16 17H8"/></svg>;
        const IconUpload = ({ className, size = 24 }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" x2="12" y1="3" y2="15"/></svg>;

        // ============================================================================
        // CONFIGURATION
        // ============================================================================
        const GAS_WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwpPUIRY-9Um1U335kTF7-4Gr3fiXit4lN5uWOC-UZ2F3kK5HvthKeDVrgOMTxpf8ik/exec";

        const DEFAULT_DEPARTMENTS = [
            "Accounting", "Admin", "Admitting", "APE/YAKAP", "Billing", "Cashier", 
            "CSR", "CQI", "ER", "HMO Claims", "HMO OPD", "HOMES", "General Services", 
            "HR", "IT", "Laboratory", "Medical Record", "NICU", "NSO", "OH Nurse", 
            "OPD", "OR", "Pharmacy", "PhilHealth", "Radiology/XRay", "Releasing", 
            "Security", "Medical Social Service", "Station 3", "Station 4B", 
            "Station 5A", "Station 5B", "Training & Development", "Ultrasound"
        ];

        // --- ULTRA-FAST Auto Resizer & Upload Component ---
        const PhotoUpload = ({ onCapture, onClear, photo }) => {
            const fileInputRef = useRef(null);
            const [error, setError] = useState('');
            const [isLoading, setIsLoading] = useState(false);

            const handleFileChange = (e) => {
                const file = e.target.files[0];
                if (!file) return;

                setIsLoading(true);
                setError('');

                // Memory-safe, instant loading via ObjectURL
                const objectUrl = URL.createObjectURL(file);
                const img = new Image();

                img.onload = () => {
                    URL.revokeObjectURL(objectUrl); // Free up phone memory instantly

                    // Auto-resizer logic: Crush down to max 800px width/height
                    const canvas = document.createElement('canvas');
                    const MAX_DIMENSION = 800;
                    let width = img.width;
                    let height = img.height;

                    if (width > height && width > MAX_DIMENSION) {
                        height *= MAX_DIMENSION / width;
                        width = MAX_DIMENSION;
                    } else if (height > MAX_DIMENSION) {
                        width *= MAX_DIMENSION / height;
                        height = MAX_DIMENSION;
                    }

                    canvas.width = width;
                    canvas.height = height;
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(img, 0, 0, width, height);
                    
                    // Compress to lightweight JPEG (reduces 10MB photo to ~50KB for lightning fast upload)
                    const fastCompressedDataUrl = canvas.toDataURL('image/jpeg', 0.6);
                    onCapture(fastCompressedDataUrl);
                    setIsLoading(false);
                };

                img.onerror = () => {
                    setError('Failed to process image. Please try another photo.');
                    setIsLoading(false);
                    URL.revokeObjectURL(objectUrl);
                };

                img.src = objectUrl;
            };

            if (photo) {
                return (
                    <div className="relative w-full rounded-xl overflow-hidden border-2 border-slate-200 bg-black">
                        <img src={photo} alt="Uploaded document photo" className="w-full h-48 object-contain" />
                        <button 
                            type="button" 
                            onClick={() => {
                                if (fileInputRef.current) fileInputRef.current.value = '';
                                onClear();
                            }}
                            className="absolute top-2 right-2 bg-red-600 text-white p-2.5 rounded-full shadow-lg hover:bg-red-700 transition active:scale-90"
                        >
                            <IconTrash size={18} />
                        </button>
                    </div>
                );
            }

            return (
                <div className="w-full">
                    {/* accept="image/*" allows ALL photos including HEIC iPhone formats */}
                    <input 
                        type="file" 
                        accept="image/*" 
                        ref={fileInputRef}
                        onChange={handleFileChange}
                        className="hidden"
                    />
                    <button 
                        type="button" 
                        onClick={() => fileInputRef.current.click()}
                        disabled={isLoading}
                        className={`w-full py-8 border-2 border-dashed border-teal-300 rounded-xl bg-teal-50 text-teal-700 hover:bg-teal-100 transition flex flex-col items-center justify-center gap-2 shadow-sm ${isLoading ? 'opacity-50 cursor-not-allowed' : 'active:scale-[0.98]'}`}
                    >
                        {isLoading ? (
                            <IconRefresh size={32} className="animate-spin" />
                        ) : (
                            <IconUpload size={32} />
                        )}
                        <span className="font-bold text-center px-4">
                            {isLoading ? 'Optimizing photo...' : 'Tap to Upload Photo from Gallery'}
                        </span>
                        {!isLoading && <span className="text-xs text-teal-600 font-medium px-4 text-center">Auto-resizer enabled for lightning-fast submission</span>}
                    </button>
                    {error && <p className="text-red-500 text-sm mt-2 font-medium">{error}</p>}
                </div>
            );
        };

        // --- Signature Pad Component ---
        const SignaturePad = ({ onReady }) => {
            const canvasRef = useRef(null);
            const [isDrawing, setIsDrawing] = useState(false);

            useEffect(() => {
                const canvas = canvasRef.current;
                const ctx = canvas.getContext('2d');
                let currentWidth = canvas.parentElement.clientWidth;
                
                const initCanvas = () => {
                    canvas.width = currentWidth;
                    canvas.height = 200;
                    ctx.lineWidth = 2.5;
                    ctx.lineCap = 'round';
                    ctx.lineJoin = 'round';
                    ctx.strokeStyle = '#0f172a';
                };
                
                initCanvas();

                const preventScroll = (e) => {
                    if (e.target === canvas) e.preventDefault();
                };
                
                const handleResize = () => {
                    if (!canvas || !canvas.parentElement) return;
                    const newWidth = canvas.parentElement.clientWidth;
                    if (newWidth !== currentWidth && newWidth > 0) {
                        const tempCanvas = document.createElement('canvas');
                        tempCanvas.width = canvas.width;
                        tempCanvas.height = canvas.height;
                        const tempCtx = tempCanvas.getContext('2d');
                        tempCtx.drawImage(canvas, 0, 0);
                        
                        currentWidth = newWidth;
                        canvas.width = currentWidth;
                        canvas.height = 200;
                        ctx.lineWidth = 2.5;
                        ctx.lineCap = 'round';
                        ctx.lineJoin = 'round';
                        ctx.strokeStyle = '#0f172a';
                        
                        ctx.drawImage(tempCanvas, 0, 0);
                    }
                };

                window.addEventListener('resize', handleResize);
                canvas.addEventListener('touchstart', preventScroll, { passive: false });
                canvas.addEventListener('touchmove', preventScroll, { passive: false });

                onReady({
                    clear: () => ctx.clearRect(0, 0, canvas.width, canvas.height),
                    isEmpty: () => {
                        const blank = document.createElement('canvas');
                        blank.width = canvas.width;
                        blank.height = canvas.height;
                        return canvas.toDataURL() === blank.toDataURL();
                    },
                    getData: () => canvas.toDataURL('image/png')
                });

                return () => {
                    window.removeEventListener('resize', handleResize);
                    canvas.removeEventListener('touchstart', preventScroll);
                    canvas.removeEventListener('touchmove', preventScroll);
                };
            }, [onReady]);

            const startDrawing = (e) => {
                const canvas = canvasRef.current;
                const ctx = canvas.getContext('2d');
                const rect = canvas.getBoundingClientRect();
                const clientX = e.touches ? e.touches[0].clientX : e.clientX;
                const clientY = e.touches ? e.touches[0].clientY : e.clientY;
                
                ctx.beginPath();
                ctx.moveTo(clientX - rect.left, clientY - rect.top);
                setIsDrawing(true);
            };

            const draw = (e) => {
                if (!isDrawing) return;
                const canvas = canvasRef.current;
                const ctx = canvas.getContext('2d');
                const rect = canvas.getBoundingClientRect();
                const clientX = e.touches ? e.touches[0].clientX : e.clientX;
                const clientY = e.touches ? e.touches[0].clientY : e.clientY;
                
                ctx.lineTo(clientX - rect.left, clientY - rect.top);
                ctx.stroke();
            };

            const stopDrawing = () => setIsDrawing(false);

            return (
                <div className="relative w-full border-2 border-slate-300 border-dashed rounded-xl overflow-hidden bg-white shadow-inner hover:border-teal-400 transition-colors">
                    <div className="absolute top-3 left-3 flex items-center gap-2 text-slate-300 pointer-events-none select-none">
                        <IconPen size={16} />
                        <span className="text-sm font-medium">Sign here directly</span>
                    </div>
                    <canvas
                        ref={canvasRef}
                        onMouseDown={startDrawing}
                        onMouseMove={draw}
                        onMouseUp={stopDrawing}
                        onMouseOut={stopDrawing}
                        onTouchStart={startDrawing}
                        onTouchMove={draw}
                        onTouchEnd={stopDrawing}
                        className="w-full cursor-crosshair touch-none"
                    />
                    <div className="absolute bottom-4 left-4 right-4 border-t border-slate-200 pointer-events-none opacity-50"></div>
                </div>
            );
        };

        // --- Main Application Component ---
        function App() {
            const [departments, setDepartments] = useState(DEFAULT_DEPARTMENTS);
            const [formData, setFormData] = useState({
                department: '',
                date: new Date().toLocaleDateString('en-CA'),
                title: '',
                controlNumber: '',
                receivedByName: ''
            });
            
            const [signaturePadAPI, setSignaturePadAPI] = useState(null);
            const [capturedPhoto, setCapturedPhoto] = useState(null);
            
            const [isSyncing, setIsSyncing] = useState(false);
            const [isSubmitting, setIsSubmitting] = useState(false);
            const [isSuccess, setIsSuccess] = useState(false);
            const [notification, setNotification] = useState({ show: false, type: '', message: '' });

            const showNotification = (type, message) => {
                setNotification({ show: true, type, message });
                setTimeout(() => setNotification({ show: false, type: '', message: '' }), 6000);
            };

            const handleInputChange = (e) => {
                const { name, value } = e.target;
                setFormData(prev => ({ ...prev, [name]: value }));
            };

            const clearForm = () => {
                setFormData({
                    department: '',
                    date: new Date().toLocaleDateString('en-CA'),
                    title: '',
                    controlNumber: '',
                    receivedByName: ''
                });
                if (signaturePadAPI) signaturePadAPI.clear();
                setCapturedPhoto(null);
                setIsSuccess(false);
            };

            const handleSync = async () => {
                setIsSyncing(true);
                try {
                    const response = await fetch(`${GAS_WEB_APP_URL}?action=getDepartments`);
                    const data = await response.json();
                    if (data.status === 'success' && data.departments && data.departments.length > 0) {
                        setDepartments(data.departments);
                        showNotification('success', 'Departments successfully updated from Sheets!');
                    } else {
                        throw new Error('No departments found');
                    }
                } catch (error) {
                    console.error('Sync error:', error);
                    showNotification('error', 'Failed to sync. Please check your internet connection and try again.');
                } finally {
                    setIsSyncing(false);
                }
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                
                if (!formData.department || !formData.date || !formData.title || !formData.receivedByName) {
                    showNotification('error', 'Please fill in all required text fields.');
                    return;
                }

                if (!capturedPhoto) {
                    showNotification('error', 'Please upload a photo verification.');
                    return;
                }

                if (!signaturePadAPI || signaturePadAPI.isEmpty()) {
                    showNotification('error', 'Please provide a digital signature.');
                    return;
                }

                setIsSubmitting(true);
                
                const payload = {
                    action: 'submitForm',
                    data: {
                        ...formData,
                        signatureData: signaturePadAPI.getData(),
                        selfieBase64: capturedPhoto.split(',')[1] // Strip prefix for Apps Script decoding
                    }
                };

                try {
                    const response = await fetch(GAS_WEB_APP_URL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'text/plain;charset=utf-8' },
                        body: JSON.stringify(payload)
                    });
                    
                    const result = await response.json();
                    
                    if (result.status === 'success') {
                        setIsSuccess(true);
                    } else {
                        throw new Error(result.message || 'Submission failed on server');
                    }
                } catch (error) {
                    console.error('Submit error:', error);
                    showNotification('error', 'Failed to submit data. Your connection might be unstable, please try again.');
                } finally {
                    setIsSubmitting(false);
                }
            };

            if (isSuccess) {
                return (
                    <div className="min-h-screen flex items-center justify-center p-4 bg-slate-100 medical-gradient">
                        <div className="max-w-md w-full glass-panel shadow-2xl rounded-3xl p-8 sm:p-10 text-center border border-white/40">
                            <div className="w-20 h-20 sm:w-24 sm:h-24 bg-teal-100 rounded-full flex items-center justify-center mx-auto mb-6 shadow-inner">
                                <IconCheckCircle size={48} className="text-teal-600" />
                            </div>
                            <h2 className="text-2xl sm:text-3xl font-bold text-slate-800 mb-3">Record Secured</h2>
                            <p className="text-sm sm:text-base text-slate-600 mb-8 font-medium">The document details, signature, and photo have been securely transmitted to the TDMH logbook.</p>
                            <button onClick={clearForm} className="w-full bg-teal-600 hover:bg-teal-700 text-white font-bold py-4 px-6 rounded-xl transition-all shadow-lg hover:shadow-xl active:scale-95 flex items-center justify-center gap-2">
                                <IconFileText size={20} />
                                Log Next Document
                            </button>
                        </div>
                    </div>
                );
            }

            return (
                <div className="pb-12 pt-4 px-3 sm:px-6 lg:px-8 max-w-3xl mx-auto">
                    
                    {/* Header Card */}
                    <div className="medical-gradient rounded-3xl shadow-xl p-5 sm:p-8 flex flex-col items-center relative mb-6 border border-teal-800">
                        <div className="w-full flex justify-end mb-4">
                            <div className="flex flex-col items-end">
                                <button 
                                    onClick={handleSync} 
                                    disabled={isSyncing} 
                                    className={`flex items-center gap-2 px-4 py-2 rounded-full text-xs font-bold transition-all shadow-md ${isSyncing ? 'bg-teal-900 text-teal-300 cursor-not-allowed' : 'bg-white text-teal-800 hover:bg-teal-50 active:scale-95'}`}
                                >
                                    <IconRefresh size={14} className={isSyncing ? 'animate-spin' : ''} />
                                    {isSyncing ? 'Syncing...' : 'Sync Data'}
                                </button>
                                <span className="text-[10px] text-teal-100 font-medium mt-1 pr-1 opacity-80">
                                    Click to fetch Departments
                                </span>
                            </div>
                        </div>

                        <div className="bg-white p-3 rounded-2xl shadow-sm mb-5 w-full max-w-[280px] sm:max-w-sm flex justify-center items-center">
                            <img 
                                src="./images logo/tdmh-logo.png" 
                                alt="TDMH Logo" 
                                className="h-10 sm:h-16 w-auto object-contain"
                                onError={(e) => { 
                                    e.target.onerror = null; 
                                    e.target.src = 'https://via.placeholder.com/280x80/ffffff/0f766e?text=TDMH+Logo'; 
                                }} 
                            />
                        </div>
                        
                        <h1 className="text-2xl sm:text-4xl font-extrabold text-white text-center tracking-tight drop-shadow-sm px-2">CQI's Receiving Record</h1>
                        <h2 className="text-[10px] sm:text-sm font-bold text-teal-100 mt-2 uppercase tracking-[0.15em] sm:tracking-[0.2em] text-center px-2">Continuous Quality Improvement</h2>
                    </div>

                    {/* Notifications */}
                    {notification.show && (
                        <div className="sticky top-4 z-50 mb-6 mx-2">
                            <div className={`p-4 rounded-xl flex items-center gap-3 shadow-lg ${notification.type === 'success' ? 'bg-green-100 text-green-800 border-2 border-green-300' : 'bg-red-100 text-red-800 border-2 border-red-300'}`}>
                                {notification.type === 'success' ? <IconCheckCircle size={24} className="text-green-600 flex-shrink-0" /> : <IconAlertCircle size={24} className="text-red-600 flex-shrink-0" />}
                                <span className="text-sm font-bold">{notification.message}</span>
                            </div>
                        </div>
                    )}

                    {/* Main Form Card */}
                    <div className="bg-white shadow-2xl shadow-teal-900/10 rounded-3xl p-4 sm:p-10 border border-slate-100">
                        <form onSubmit={handleSubmit} className="space-y-8">
                            
                            {/* Section 1: Document Details */}
                            <div>
                                <h3 className="text-lg font-bold text-teal-800 mb-4 border-b border-teal-100 pb-2 flex items-center gap-2">
                                    <IconFileText size={20}/> Document Information
                                </h3>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-5 sm:gap-6 mb-6">
                                    <div className="space-y-2">
                                        <label className="text-sm font-bold text-slate-700 block">Department <span className="text-red-500">*</span></label>
                                        <select name="department" value={formData.department} onChange={handleInputChange} required className="w-full bg-slate-50 border-2 border-slate-200 text-slate-900 text-base sm:text-sm rounded-xl focus:ring-0 focus:border-teal-500 block p-3.5 transition-colors font-medium">
                                            <option value="" disabled>Select Department</option>
                                            {departments.map((dept, i) => <option key={i} value={dept}>{dept}</option>)}
                                        </select>
                                    </div>
                                    <div className="space-y-2">
                                        <label className="text-sm font-bold text-slate-700 block">Date <span className="text-red-500">*</span></label>
                                        <input type="date" name="date" value={formData.date} readOnly className="w-full bg-slate-100 border-2 border-slate-200 text-slate-500 text-base sm:text-sm rounded-xl block p-3.5 cursor-not-allowed select-none font-medium" />
                                    </div>
                                </div>

                                <div className="space-y-5 sm:space-y-6">
                                    <div className="space-y-2">
                                        <label className="text-sm font-bold text-slate-700 block">Title of Document/s <span className="text-red-500">*</span></label>
                                        <input type="text" name="title" value={formData.title} onChange={handleInputChange} required placeholder="e.g. Monthly Audit Report" className="w-full bg-slate-50 border-2 border-slate-200 text-slate-900 text-base sm:text-sm rounded-xl focus:ring-0 focus:border-teal-500 block p-3.5 transition-colors font-medium placeholder-slate-400" />
                                    </div>

                                    <div className="space-y-2">
                                        <label className="text-sm font-bold text-slate-700 block">Control Number of Form/s <span className="text-slate-400 font-normal">(Optional)</span></label>
                                        <input type="text" name="controlNumber" value={formData.controlNumber} onChange={handleInputChange} placeholder="e.g. TDMH-CQI-F-001-4-0" className="w-full bg-slate-50 border-2 border-slate-200 text-slate-900 text-base sm:text-sm rounded-xl focus:ring-0 focus:border-teal-500 block p-3.5 transition-colors font-medium placeholder-slate-400 uppercase" />
                                    </div>
                                </div>
                            </div>

                            {/* Section 2: Receiver Identity */}
                            <div className="bg-slate-50 p-4 sm:p-6 rounded-2xl border border-slate-200">
                                <h3 className="text-lg font-bold text-teal-800 mb-4 border-b border-teal-100 pb-2 flex items-center gap-2">
                                    <IconUpload size={20}/> Proof of Receipt
                                </h3>
                                
                                <div className="space-y-6">
                                    <div className="space-y-2">
                                        <label className="text-sm font-bold text-slate-700 block">Received by (Full Name) <span className="text-red-500">*</span></label>
                                        <input type="text" name="receivedByName" value={formData.receivedByName} onChange={handleInputChange} required placeholder="Type full name of the receiver..." className="w-full bg-white border-2 border-slate-200 text-slate-900 text-base sm:text-sm rounded-xl focus:ring-0 focus:border-teal-500 block p-3.5 transition-colors font-bold placeholder-slate-400" />
                                    </div>

                                    {/* Fast Upload Feature */}
                                    <div className="space-y-2">
                                        <label className="text-sm font-bold text-slate-700 block">Receiver Photo Verification <span className="text-red-500">*</span></label>
                                        <PhotoUpload 
                                            onCapture={setCapturedPhoto} 
                                            onClear={() => setCapturedPhoto(null)} 
                                            photo={capturedPhoto} 
                                        />
                                    </div>

                                    {/* Direct Signature */}
                                    <div className="space-y-2">
                                        <label className="text-sm font-bold text-slate-700 flex justify-between items-end">
                                            <span>Digital Signature <span className="text-red-500">*</span></span>
                                            <button type="button" onClick={() => signaturePadAPI && signaturePadAPI.clear()} className="text-xs flex items-center gap-1 text-slate-500 hover:text-red-600 transition-colors font-bold bg-white px-2.5 py-1.5 rounded-lg shadow-sm border border-slate-200 active:scale-95">
                                                <IconTrash size={14} /> Clear Pad
                                            </button>
                                        </label>
                                        <SignaturePad onReady={setSignaturePadAPI} />
                                        <p className="text-[10px] text-slate-500 font-medium">Sign directly inside the box above.</p>
                                    </div>
                                </div>
                            </div>

                            {/* Submit Actions */}
                            <div className="pt-2 flex flex-col sm:flex-row gap-3">
                                <button type="button" onClick={clearForm} className="w-full sm:w-1/3 px-6 py-4 rounded-xl font-bold text-slate-600 bg-slate-100 border border-slate-200 hover:bg-slate-200 transition-all active:scale-95">
                                    Reset Form
                                </button>
                                <button type="submit" disabled={isSubmitting} className={`w-full sm:w-2/3 flex items-center justify-center gap-2 px-6 py-4 rounded-xl font-bold text-white transition-all shadow-lg ${isSubmitting ? 'bg-teal-400 cursor-not-allowed' : 'medical-gradient hover:shadow-xl hover:-translate-y-0.5 active:scale-95'}`}>
                                    {isSubmitting ? <><IconRefresh size={20} className="animate-spin" /> Transmitting Data...</> : <><IconSend size={20} /> Submit Official Record</>}
                                </button>
                            </div>
                        </form>
                    </div>

                    <div className="mt-8 text-center pb-6">
                        <p className="text-[10px] sm:text-xs text-slate-400 font-bold tracking-widest">
                            &copy; 2026 Taytay Doctors Multispecialty Hospital. All Rights Reserved.
                        </p>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
